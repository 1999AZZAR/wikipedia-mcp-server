{
  "openapi": "3.0.0",
  "info": {
    "title": "Wikipedia MCP Server API",
    "version": "1.0.0",
    "description": "OpenAPI specification for the Wikipedia MCP Server with comprehensive Wikipedia access via Model Context Protocol"
  },
  "servers": [
    {
      "url": "http://localhost:8787",
      "description": "Development server"
    },
    {
      "url": "https://your-worker.your-subdomain.workers.dev",
      "description": "Production server"
    }
  ],
  "paths": {
    "/mcp": {
      "post": {
        "summary": "Model Context Protocol Interface",
        "description": "Primary endpoint for MCP tool calls using JSON-RPC 2.0",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "jsonrpc": { "type": "string", "enum": ["2.0"] },
                  "method": { "type": "string", "enum": ["tools/call"] },
                  "params": {
                    "type": "object",
                    "properties": {
                      "name": { "type": "string", "description": "Tool name" },
                      "arguments": { "type": "object", "description": "Tool-specific arguments" }
                    },
                    "required": ["name", "arguments"]
                  },
                  "id": { "type": "string", "description": "Request ID" }
                },
                "required": ["jsonrpc", "method", "params", "id"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MCPResponse"
                }
              }
            }
          },
          "400": { "description": "Bad Request" },
          "500": { "description": "Internal Server Error" }
        }
      }
    },
    "/schema": {
      "get": {
        "summary": "Get Server Schema",
        "description": "Retrieve the complete server schema with all available tools and their parameters",
        "responses": {
          "200": {
            "description": "Server schema",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "tools": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Tool"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health Check",
        "description": "Get comprehensive health status, diagnostics, and real-time analytics",
        "responses": {
          "200": {
            "description": "Health status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "MCPResponse": {
        "type": "object",
        "properties": {
          "jsonrpc": { "type": "string", "enum": ["2.0"] },
          "result": {
            "type": "object",
            "properties": {
              "content": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "type": { "type": "string", "enum": ["text"] },
                    "text": { "type": "string" }
                  }
                }
              }
            }
          },
          "error": {
            "type": "object",
            "properties": {
              "code": { "type": "number" },
              "message": { "type": "string" },
              "data": { "type": "object" }
            }
          },
          "id": { "type": "string" }
        }
      },
      "Tool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "description": "Tool name" },
          "description": { "type": "string", "description": "Tool description" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "type": { "type": "string", "enum": ["object"] },
              "properties": { "type": "object" },
              "required": { "type": "array", "items": { "type": "string" } }
            }
          }
        },
        "required": ["name", "description", "inputSchema"]
      },
      "SearchTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["search"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "query": { "type": "string", "description": "The search query" },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" },
              "limit": { "type": "number", "default": 10, "description": "Maximum number of results" },
              "offset": { "type": "number", "default": 0, "description": "Pagination offset" },
              "includeSnippets": { "type": "boolean", "default": true, "description": "Include search snippets" }
            },
            "required": ["query"]
          }
        }
      },
      "GetPageTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["getPage"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "title": { "type": "string", "description": "Wikipedia page title" },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" },
              "sections": { "type": "boolean", "default": true, "description": "Include page sections" },
              "images": { "type": "boolean", "default": false, "description": "Include page images" },
              "links": { "type": "boolean", "default": false, "description": "Include page links" },
              "categories": { "type": "boolean", "default": false, "description": "Include page categories" }
            },
            "required": ["title"]
          }
        }
      },
      "GetPageSummaryTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["getPageSummary"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "title": { "type": "string", "description": "Wikipedia page title" },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" }
            },
            "required": ["title"]
          }
        }
      },
      "GetPageByIdTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["getPageById"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "id": { "type": "number", "description": "Wikipedia page ID" },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" },
              "sections": { "type": "boolean", "default": true, "description": "Include page sections" },
              "images": { "type": "boolean", "default": false, "description": "Include page images" },
              "links": { "type": "boolean", "default": false, "description": "Include page links" },
              "categories": { "type": "boolean", "default": false, "description": "Include page categories" }
            },
            "required": ["id"]
          }
        }
      },
      "RandomTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["random"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" }
            }
          }
        }
      },
      "PageLanguagesTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["pageLanguages"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "title": { "type": "string", "description": "Wikipedia page title" },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" }
            },
            "required": ["title"]
          }
        }
      },
      "BatchSearchTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["batchSearch"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "queries": { 
                "type": "array", 
                "items": { "type": "string" }, 
                "minItems": 1, 
                "maxItems": 10, 
                "description": "Array of search queries" 
              },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" },
              "limit": { "type": "number", "default": 5, "description": "Maximum results per query" },
              "concurrency": { "type": "number", "default": 5, "description": "Concurrent request limit" }
            },
            "required": ["queries"]
          }
        }
      },
      "BatchGetPagesTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["batchGetPages"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "titles": { 
                "type": "array", 
                "items": { "type": "string" }, 
                "minItems": 1, 
                "maxItems": 10, 
                "description": "Array of page titles" 
              },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" },
              "sections": { "type": "boolean", "default": true, "description": "Include page sections" },
              "concurrency": { "type": "number", "default": 5, "description": "Concurrent request limit" }
            },
            "required": ["titles"]
          }
        }
      },
      "SearchNearbyTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["searchNearby"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "lat": { "type": "number", "minimum": -90, "maximum": 90, "description": "Latitude coordinate" },
              "lon": { "type": "number", "minimum": -180, "maximum": 180, "description": "Longitude coordinate" },
              "radius": { "type": "number", "default": 1000, "description": "Search radius in meters" },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" },
              "limit": { "type": "number", "default": 10, "description": "Maximum results to return" }
            },
            "required": ["lat", "lon"]
          }
        }
      },
      "GetPagesInCategoryTool": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "enum": ["getPagesInCategory"] },
          "description": { "type": "string" },
          "inputSchema": {
            "type": "object",
            "properties": {
              "category": { "type": "string", "description": "Category name" },
              "lang": { "type": "string", "default": "en", "description": "Wikipedia language edition" },
              "limit": { "type": "number", "default": 20, "description": "Maximum pages to return" },
              "type": { "type": "string", "enum": ["page", "subcat", "file"], "default": "page", "description": "Type of category members" }
            },
            "required": ["category"]
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": { "type": "string", "enum": ["ok", "error"] },
          "timestamp": { "type": "string", "format": "date-time" },
          "service": {
            "type": "object",
            "properties": {
              "status": { "type": "string", "enum": ["healthy", "degraded", "unhealthy"] },
              "endpoints": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "language": { "type": "string" },
                    "endpoints": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "url": { "type": "string" },
                          "status": { "type": "object" }
                        }
                      }
                    }
                  }
                }
              },
              "cache": {
                "type": "object",
                "properties": {
                  "memory": { "type": "object" },
                  "kv": { "type": "object" }
                }
              },
              "deduplication": { "type": "object" }
            }
          },
          "monitoring": {
            "type": "object",
            "properties": {
              "requestRate": { "type": "number" },
              "errorRate": { "type": "number" },
              "avgResponseTime": { "type": "number" }
            }
          }
        }
      }
    }
  }
}